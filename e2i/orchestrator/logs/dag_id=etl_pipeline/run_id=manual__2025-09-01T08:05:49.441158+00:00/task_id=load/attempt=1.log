[2025-09-01T08:06:02.987+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: etl_pipeline.load manual__2025-09-01T08:05:49.441158+00:00 [queued]>
[2025-09-01T08:06:03.003+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: etl_pipeline.load manual__2025-09-01T08:05:49.441158+00:00 [queued]>
[2025-09-01T08:06:03.004+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 1
[2025-09-01T08:06:03.026+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): load> on 2025-09-01 08:05:49.441158+00:00
[2025-09-01T08:06:03.049+0000] {standard_task_runner.py:60} INFO - Started process 189 to run task
[2025-09-01T08:06:03.054+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'etl_pipeline', 'load', 'manual__2025-09-01T08:05:49.441158+00:00', '--job-id', '45', '--raw', '--subdir', 'DAGS_FOLDER/etl_pipeline.py', '--cfg-path', '/tmp/tmplo9dk05k']
[2025-09-01T08:06:03.058+0000] {standard_task_runner.py:88} INFO - Job 45: Subtask load
[2025-09-01T08:06:03.088+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:194 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-09-01T08:06:03.147+0000] {task_command.py:423} INFO - Running <TaskInstance: etl_pipeline.load manual__2025-09-01T08:05:49.441158+00:00 [running]> on host bb28ba12f451
[2025-09-01T08:06:03.230+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='etl_pipeline' AIRFLOW_CTX_TASK_ID='load' AIRFLOW_CTX_EXECUTION_DATE='2025-09-01T08:05:49.441158+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-09-01T08:05:49.441158+00:00'
[2025-09-01T08:06:03.244+0000] {etl_pipeline.py:137} INFO - Reading processed file /tmp/etl_processed/processed_c7a5acd1-831b-42c9-9375-2fdc0926e650_applicants.csv
[2025-09-01T08:06:03.280+0000] {etl_pipeline.py:161} INFO - Inserting 20 rows into ClickHouse table applicants
[2025-09-01T08:06:03.298+0000] {etl_pipeline.py:164} ERROR - Failed to insert into ClickHouse: Code: 516.
DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.

If you use ClickHouse Cloud, the password can be reset at https://clickhouse.cloud/
on the settings page for the corresponding service.

If you have installed ClickHouse and forgot password you can reset it in the configuration file.
The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
and deleting this file will reset the password.
See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.

. Stack trace:

0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x0000000010c92930
1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000b730698
2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000b730168
3. DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ClientInfo const&) const @ 0x0000000013b76854
4. DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&, std::vector<String, std::allocator<String>> const&) @ 0x0000000014ff7660
5. DB::Session::authenticate(String const&, String const&, Poco::Net::SocketAddress const&, std::vector<String, std::allocator<String>> const&) @ 0x0000000014ff6d14
6. DB::TCPHandler::receiveHello() @ 0x000000001660846c
7. DB::TCPHandler::runImpl() @ 0x00000000165fbf20
8. DB::TCPHandler::run() @ 0x000000001661aae4
9. Poco::Net::TCPServerConnection::start() @ 0x000000001b0f9e98
10. Poco::Net::TCPServerDispatcher::run() @ 0x000000001b0fa434
11. Poco::PooledThread::run() @ 0x000000001b0c03dc
12. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001b0be750
13. ? @ 0x000000000007d5b8
14. ? @ 0x00000000000e5edc
Traceback (most recent call last):
  File "/opt/airflow/dags/etl_pipeline.py", line 162, in perform_load
    client.execute(insert_sql, records)
  File "/home/airflow/.local/lib/python3.8/site-packages/clickhouse_driver/client.py", line 370, in execute
    with self.disconnect_on_error(query, settings):
  File "/usr/local/lib/python3.8/contextlib.py", line 113, in __enter__
    return next(self.gen)
  File "/home/airflow/.local/lib/python3.8/site-packages/clickhouse_driver/client.py", line 313, in disconnect_on_error
    self.establish_connection(settings)
  File "/home/airflow/.local/lib/python3.8/site-packages/clickhouse_driver/client.py", line 300, in establish_connection
    self.connection.force_connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/clickhouse_driver/connection.py", line 258, in force_connect
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/clickhouse_driver/connection.py", line 399, in connect
    return self._init_connection(host, port)
  File "/home/airflow/.local/lib/python3.8/site-packages/clickhouse_driver/connection.py", line 343, in _init_connection
    self.receive_hello()
  File "/home/airflow/.local/lib/python3.8/site-packages/clickhouse_driver/connection.py", line 528, in receive_hello
    raise self.receive_exception()
clickhouse_driver.errors.ServerException: Code: 516.
DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.

If you use ClickHouse Cloud, the password can be reset at https://clickhouse.cloud/
on the settings page for the corresponding service.

If you have installed ClickHouse and forgot password you can reset it in the configuration file.
The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
and deleting this file will reset the password.
See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.

. Stack trace:

0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x0000000010c92930
1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000b730698
2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000b730168
3. DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ClientInfo const&) const @ 0x0000000013b76854
4. DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&, std::vector<String, std::allocator<String>> const&) @ 0x0000000014ff7660
5. DB::Session::authenticate(String const&, String const&, Poco::Net::SocketAddress const&, std::vector<String, std::allocator<String>> const&) @ 0x0000000014ff6d14
6. DB::TCPHandler::receiveHello() @ 0x000000001660846c
7. DB::TCPHandler::runImpl() @ 0x00000000165fbf20
8. DB::TCPHandler::run() @ 0x000000001661aae4
9. Poco::Net::TCPServerConnection::start() @ 0x000000001b0f9e98
10. Poco::Net::TCPServerDispatcher::run() @ 0x000000001b0fa434
11. Poco::PooledThread::run() @ 0x000000001b0c03dc
12. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001b0be750
13. ? @ 0x000000000007d5b8
14. ? @ 0x00000000000e5edc

[2025-09-01T08:06:03.301+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/opt/airflow/dags/etl_pipeline.py", line 162, in perform_load
    client.execute(insert_sql, records)
  File "/home/airflow/.local/lib/python3.8/site-packages/clickhouse_driver/client.py", line 370, in execute
    with self.disconnect_on_error(query, settings):
  File "/usr/local/lib/python3.8/contextlib.py", line 113, in __enter__
    return next(self.gen)
  File "/home/airflow/.local/lib/python3.8/site-packages/clickhouse_driver/client.py", line 313, in disconnect_on_error
    self.establish_connection(settings)
  File "/home/airflow/.local/lib/python3.8/site-packages/clickhouse_driver/client.py", line 300, in establish_connection
    self.connection.force_connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/clickhouse_driver/connection.py", line 258, in force_connect
    self.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/clickhouse_driver/connection.py", line 399, in connect
    return self._init_connection(host, port)
  File "/home/airflow/.local/lib/python3.8/site-packages/clickhouse_driver/connection.py", line 343, in _init_connection
    self.receive_hello()
  File "/home/airflow/.local/lib/python3.8/site-packages/clickhouse_driver/connection.py", line 528, in receive_hello
    raise self.receive_exception()
clickhouse_driver.errors.ServerException: Code: 516.
DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.

If you use ClickHouse Cloud, the password can be reset at https://clickhouse.cloud/
on the settings page for the corresponding service.

If you have installed ClickHouse and forgot password you can reset it in the configuration file.
The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
and deleting this file will reset the password.
See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.

. Stack trace:

0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x0000000010c92930
1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000b730698
2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000b730168
3. DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ClientInfo const&) const @ 0x0000000013b76854
4. DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&, std::vector<String, std::allocator<String>> const&) @ 0x0000000014ff7660
5. DB::Session::authenticate(String const&, String const&, Poco::Net::SocketAddress const&, std::vector<String, std::allocator<String>> const&) @ 0x0000000014ff6d14
6. DB::TCPHandler::receiveHello() @ 0x000000001660846c
7. DB::TCPHandler::runImpl() @ 0x00000000165fbf20
8. DB::TCPHandler::run() @ 0x000000001661aae4
9. Poco::Net::TCPServerConnection::start() @ 0x000000001b0f9e98
10. Poco::Net::TCPServerDispatcher::run() @ 0x000000001b0fa434
11. Poco::PooledThread::run() @ 0x000000001b0c03dc
12. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001b0be750
13. ? @ 0x000000000007d5b8
14. ? @ 0x00000000000e5edc


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 199, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 216, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/etl_pipeline.py", line 214, in run_load
    perform_load(processed_path=processed_path)
  File "/opt/airflow/dags/etl_pipeline.py", line 165, in perform_load
    raise RuntimeError(f"Load failed for {processed_path} into {CLICKHOUSE_TABLE}") from e
RuntimeError: Load failed for /tmp/etl_processed/processed_c7a5acd1-831b-42c9-9375-2fdc0926e650_applicants.csv into applicants
[2025-09-01T08:06:03.318+0000] {taskinstance.py:1138} INFO - Marking task as FAILED. dag_id=etl_pipeline, task_id=load, execution_date=20250901T080549, start_date=20250901T080602, end_date=20250901T080603
[2025-09-01T08:06:03.328+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 45 for task load (Load failed for /tmp/etl_processed/processed_c7a5acd1-831b-42c9-9375-2fdc0926e650_applicants.csv into applicants; 189)
[2025-09-01T08:06:03.363+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-09-01T08:06:03.387+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
